import re
import csv


# function to take in pasted chunks of text from UCRP/GEP documents and return investments in CSV formats
# a PDF extraction tool should be built in the future to fully automate this process. 

def split_at_first_number(text):
   
    pattern = r'(\b\d{1,3}(?:,\d{3})+\b)'

    match = re.search(pattern, text)
    if match:
        index = match.start()
        return text[:index].strip(), int(text[index:].strip().replace(',',''))
    return text, ""

def write_to_csv(text_chunk, filename="Data-Collection/Helper-Functions/individual-fund-outputs/GEP-REAL-ESTATE.csv"):
  
    lines = text_chunk.strip().split("\n")
    
    rows = [split_at_first_number(line) for line in lines]
    
    with open(filename, mode='w', newline='') as file:
        writer = csv.writer(file)
        writer.writerow(["Name", "Amount"]) 
        writer.writerows(rows) 


text_chunk = """
BREIT 1,544,349,518
BLACKSTONE GROUP CO-INVESTMENT 171,540,807
BROOKFIELD STRATEGIC REAL ESTATE PARTNERS III 105,264,561
BLACKSTONE PROPERTY PARTNERS US, LP 87,789,337
PROLOGIS TARGETED U.S. LOGISTICS FUND 74,967,155
IPI DATA CENTER FUND I 60,403,853
KSL CAPITAL PARTNERS V, L.P. 59,731,620
BLACKSTONE BIOMED LIFE SCIENCE REAL ESTATE, LP 53,392,398
BLUE VISTA BOSTON 52,786,040
LION INDUSTRIAL TRUST 48,189,749
BLACKSTONE REAL ESTATE PARTNERS ASIA II 45,475,749
BLACKSTONE REAL ESTATE PARTNERS IX, LP 44,505,821
BROOKFIELD FAIRFIELD VAMF III 42,845,162
BLACKSTONE PROPERTY PARTNERS EUROPE 32,064,535
BROOKFIELD ASSET MANAGEMENT CO-INVESTMENT 31,864,006
UC VENTURES SEPARATE ACCOUNT 30,786,260
FOCUS SENIOR HOUSING FUND I 30,136,752
PRISA LP 29,823,039
BLUE VISTA STUDENT HOUSING SELECT STRATEGIES FUND 22,280,276
BLUE VISTA STUDENT HOUSING SEPEARTE ACCOUNT 20,898,737
LIONSTONE INVESTMENTS SEPARATE ACCOUNT 15,779,122
KKR REAL ESTATE PARTNERS II 15,458,929
CIM FUND VIII 13,512,692
KKR CO-INVESTMENT 13,189,167
HEITMAN HART 9,186,340
CLARION PARTNERS SEPARATE ACCOUNT 8,617,873
LIONSTONE INVESTMENTS SEPARATE ACCOUNT 8,016,420
TRI PACIFIC CAPITAL ADVISORS SEPARATE ACCOUNT 5,125,115
CERBERUS REAL ESTATE III 4,796,285
SAGEHALL PARTNERS FUND I LP 4,474,352
SAGEHALL PARTNERS SEPARATE ACCOUNT 4,451,279
BLACKSTONE REAL ESTATE PARTNERS X LP 3,761,409
KSL CAPITAL PARTNERS III 3,573,149
WESTBROOK REAL ESTATE FUND VIII 3,448,339
BUCHANAN INVESTMENTS SEPARATE ACCOUNT 2,614,491
WALTON STREET REAL ESTATE FUND VI 2,521,403
CLARION PARTNERS SEPARATE ACCOUNT 2,162,853
CIM REAL ESTATE FUND III 2,122,521
WESTBROOK REAL ESTATE FUND IX 1,862,614
BLACKSTONE REAL ESTATE PARTNERS VII 1,585,128
WESTBROOK REAL ESTATE FUND VII 493,709
ROCKPOINT REAL ESTATE FUND IV 445,626
JP MORGAN SEPARATE ACCOUNT 330,670
LIONSTONE INVESTMENTS SEPARATE ACCOUNT 235,122
CLARION PARTNERS SEPARATE ACCOUNT 156,288
BLACKSTONE REAL ESTATE PARTNERS VI 154,041
LIONSTONE INVESTMENTS SEPARATE ACCOUNT 153,195
LIONSTONE INVESTMENTS SEPARATE ACCOUNT 117,108
ROCKPOINT REAL ESTATE FUND III 107,590
BLACKSTONE FUND V 57,928
METROPOLITAN WORKFORCE HOUSING FUND 53,219
JP MORGAN SEPARATE ACCOUNT 32,193
TRI PACIFIC CAPITAL ADVISORS SEPARATE ACCOUNT 6,521
"""

write_to_csv(text_chunk)
